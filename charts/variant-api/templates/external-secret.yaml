{{- $fullName := (include "chart.fullname" .) -}}
{{- $labels := (include "chart.labels" .) -}}
{{- $secrets := .Values.secrets -}}
{{- range $secrets }}
apiVersion: 'kubernetes-client.io/v1'
kind: ExternalSecret
metadata:
  name: {{ $fullName }}-{{ required "name is required for each secret" .name }}
  labels:
    {{- $labels | nindent 4 }}
spec:
  backendType: secretsManager
  data:
    - key: {{ required "name is required for each secret" .name }}
      name: {{ required "fileName is required for each secret" .fileName }}
{{- end -}}
